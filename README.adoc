# Building a real-time analytics dashboard with Streamlit, Apache Pinot, and Apache Pulsar

Clone repository

[source, bash]
----
git clone git@github.com:mneedham/pinot-wiki.git && cd pinot-wiki && git checkout pulsar
----

Download Pinot/Pulsar connector (shaded.jar) from https://search.maven.org/search?q=a:pinot-pulsar and copy it in the `plugins` directory. 

Spin up all components

[source, bash]
----
docker-compose up
----

or on the Mac M1:

[source, bash]
----
docker-compose -f docker-compose-m1.yml up
----

Setup Python

[source, bash]
----
python -m venv .venv
source venv/bin/activate
pip install -r requirements.txt
----

Ingest Wikipedia events

[source, bash]
----
python wiki_to_pulsar.py
----

Donwload Pulsar

[source, bash]
----
wget https://archive.apache.org/dist/pulsar/pulsar-2.10.2/apache-pulsar-2.10.2-bin.tar.gz
----

Check Wikipedia events are ingesting

[souce, bash]
----
pulsar-client consume wiki-events -s pinot-subscription -n 0
----

Add Pinot Table

[source, bash]
----
docker exec -it pinot-controller-wiki bin/pinot-admin.sh AddTable \
  -tableConfigFile /config/table-pulsar.json \
  -schemaFile /config/schema.json \
  -exec
----

Open the Pinot UI http://localhost:9000/

Run Streamlit app

[source, bash]
----
streamlit run streamlit/app.py
----
